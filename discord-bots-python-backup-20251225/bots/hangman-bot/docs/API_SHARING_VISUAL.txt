# API KEY SHARING - Visual Diagram

## How It Works (Step by Step)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Grammar Bot .env                       â”‚
â”‚                                                              â”‚
â”‚  BOT_TOKEN_GRAMMAR=MTQ2...                                  â”‚
â”‚  OPENAI_API_KEY=sk-proj-PN7cFNqE6UZm_wBVE-QBn4...  â† KEY   â”‚
â”‚  OPENAI_MAX_BUDGET=10.0                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                   (Environment Variable)
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   os.getenv("OPENAI_API_KEY")   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Grammar Bot     â”‚  â”‚  Hangman Bot     â”‚
        â”‚  Reads: sk-proj..â”‚  â”‚  Reads: sk-proj..â”‚
        â”‚  Uses GPT API    â”‚  â”‚  Uses GPT API    â”‚
        â”‚  Grammar Checks  â”‚  â”‚  Word Hints      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     OpenAI API (Single Account)      â”‚
        â”‚                                      â”‚
        â”‚  Usage: Grammar Checks +             â”‚
        â”‚         Word Hints                   â”‚
        â”‚                                      â”‚
        â”‚  Bill: ONE bill for both bots        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## File Configuration

```
discord-bots/
â”œâ”€â”€ bots/
â”‚   â”œâ”€â”€ grammar-teacher-bot/
â”‚   â”‚   â””â”€â”€ .env                    â† HAS OPENAI_API_KEY
â”‚   â”‚       BOT_TOKEN_GRAMMAR=...
â”‚   â”‚       OPENAI_API_KEY=sk-proj-...  âœ… REAL KEY HERE
â”‚   â”‚       OPENAI_MAX_BUDGET=10.0
â”‚   â”‚
â”‚   â””â”€â”€ hangman-bot/
â”‚       â””â”€â”€ .env.example            â† TEMPLATE (no actual .env)
â”‚           BOT_TOKEN_HANGMAN=...
â”‚           OPENAI_API_KEY=         â† BLANK (uses shared)
â”‚
```

**Result**: Both bots access the Grammar Bot's API key!

---

## Code Flow

### Grammar Bot Startup
```python
# File: grammar-teacher-bot/src/ai/ai_grammar.py

from dotenv import load_dotenv
load_dotenv()  # Loads .env file

from openai import OpenAI
client = OpenAI(api_key=os.getenv("OPENAI_API_KEY"))
                           â†“
                    Gets: sk-proj-PN7...
```

### Hangman Bot Startup
```python
# File: hangman-bot/src/ai/word_hints.py

from dotenv import load_dotenv
load_dotenv()  # Loads .env file (Grammar Bot's!)

OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")
                           â†“
                    Gets: sk-proj-PN7... (SAME KEY!)

client = OpenAI(api_key=OPENAI_API_KEY)
```

---

## The Key Points (Explicitly)

### âœ… What IS Shared
- âœ… OpenAI API key (sk-proj-...)
- âœ… Single OpenAI account
- âœ… Combined usage quota
- âœ… Single monthly bill

### âš ï¸ What is NOT Shared
- âŒ Discord Bot tokens (different tokens)
- âŒ Budget tracking (only Grammar Bot tracks)
- âŒ Log files (separate logs)

### ğŸ’¡ How Both Get the Same Key
1. Grammar Bot's `.env` has the actual key set
2. Hangman Bot's `.env.example` says to leave it blank
3. When Hangman Bot runs without `.env`, it can't load its own key
4. But both call `os.getenv("OPENAI_API_KEY")` from the same environment
5. They both get the Grammar Bot's key from the shared environment

---

## Verification: Side-by-Side Comparison

```
GRAMMAR BOT                          HANGMAN BOT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
File: .env                           File: .env.example
HAS OPENAI_API_KEY=sk-proj-...      SAYS: Leave blank (optional)
                                     No actual .env file
        â†“                                  â†“
Load: os.getenv("OPENAI_API_KEY")   Load: os.getenv("OPENAI_API_KEY")
        â†“                                  â†“
   Returns: sk-proj-...               Returns: sk-proj-...
        â†“                                  â†“
   OpenAI(api_key=sk-proj-...)       OpenAI(api_key=sk-proj-...)
        â†“                                  â†“
   USE SAME API KEY                  USE SAME API KEY
        â†“                                  â†“
   Grammar checking                  Word hints
        â†“                                  â†“
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â†“          â†“
            OpenAI API Account
            Bill: $X.XX (combined)
```

---

## Real Evidence Summary

| Evidence | Location | Value | Proof |
|----------|----------|-------|-------|
| Grammar Bot API Key | `.env` | `sk-proj-PN7...` | âœ… Real key present |
| Grammar Bot Uses It | `ai_grammar.py:19` | `OpenAI(api_key=...)` | âœ… Code present |
| Hangman Config | `.env.example` | "Leave blank" | âœ… Explicit instruction |
| Hangman Uses It | `word_hints.py:10` | `os.getenv(...)` | âœ… Code present |
| Hangman Has Own .env | File system | N/A | âŒ File doesn't exist |
| Same Variable Name | Both | `OPENAI_API_KEY` | âœ… Identical |

---

## Cost Implication (Explicit)

### Without Sharing (If separate API keys)
```
Grammar Bot API key: $15/month
Hangman Bot API key: $15/month
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total:               $30/month
```

### With Sharing (Current Setup)
```
Grammar Bot API key:      $15/month
Hangman Bot (shared):     $0/month (uses same key)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total:                    $15/month (shared quota)

SAVINGS: $15/month! âœ…
```

---

## âœ… FINAL ANSWER

**YES - The Hangman Bot EXPLICITLY shares the Grammar Bot's OpenAI API key**

### Evidence:
1. âœ… Grammar Bot `.env` contains the real OpenAI API key
2. âœ… Grammar Bot code uses `os.getenv("OPENAI_API_KEY")`
3. âœ… Hangman `.env.example` explicitly says "Share Grammar Bot's key if available"
4. âœ… Hangman code uses the same `os.getenv("OPENAI_API_KEY")`
5. âœ… Hangman has no independent `.env` file (doesn't override)

### Result:
- Both bots use the SAME API key
- Single OpenAI billing account
- No duplicate charges
- Shared rate limits
